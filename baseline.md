## Построение бейзлайна

Цель данной работы построение бейзлайна и его улучшение с помощью простейших моделей, для предсказания направления изменения ставки рефинансирования ЦБ. Это наша отправная точка для сравнения и улучшения.

### План работы

0. Общая предобработка данных.
1. Минимальный бейзлайн.
2. Статистические методы :
    - Мешок слов плюс линейная модель
    - TF-IDF плюс линейная модель
    - N-граммы плюс Naive Bayes
3. Создание эмбеддингов:
    - Word2Vec плюс линейная модель
    - GloVe плюс линейная модель
4. Выводы

### Ноутбуки с экспериментами

- [min_baseline.ipynb](ml/min_baseline.ipynb) - минимальный бейзлайн. Модель предсказывает изменение ставки таким, как в последнем решении.
- [dummy.ipynb](ml/dummy.ipynb) - простейшее предсказание на основе самого частотного класса (вне рейтинга).
- [bag_of_words.ipynb](ml/bag_of_words.ipynb) - Bag of Words плюс линейные модели (логистическая регрессия регрессия и SVM).
- [tf_idf.ipynb](ml/tf_idf.ipynb) - TF-IDF плюс линейные модели. Здесь была получена наилучшая модель.
- [n_grams_naive_bayes.ipynb](ml/n_grams_naive_bayes.ipynb) - N-граммы плюс наивный байесовский классификатор.
- [word2vec.ipynb](ml/word2vec.ipynb) - Word2Vec плюс линейная модель.
- [glove.ipynb](ml/glove.ipynb) - GloVe плюс линейная модель.
- [pipeline.ipynb](ml/pipeline.ipynb) - пайплайн обучения и применения лучшей модели (TF-IDF + SVM).

### Метрики исследованных моделей

<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>Модель</th>
      <th>Accuracy</th>
      <th>F-score</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>ROC AUC OvR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Минимальный бейзлайн</th>
      <td>0.663158</td>
      <td>0.667893</td>
      <td>0.669919</td>
      <td>0.666111</td>
      <td>0.745010</td>
    </tr>
    <tr>
      <th>BoW (тексты релизов) + LogReg с L1-регуляризацией</th>
      <td>0.621212</td>
      <td>0.627058</td>
      <td>0.642995</td>
      <td>0.619311</td>
      <td>0.769110</td>
    </tr>
    <tr>
      <th>BoW + LogReg с L1-, L2-регуляризацией</th>
      <td>0.681818</td>
      <td>0.686510</td>
      <td>0.705556</td>
      <td>0.678521</td>
      <td>0.861207</td>
    </tr>
    <tr>
      <th>BoW (тексты релизов + заголовки) + LogReg</th>
      <td>0.681818</td>
      <td>0.686510</td>
      <td>0.705556</td>
      <td>0.678521</td>
      <td>0.861207</td>
    </tr>
    <tr>
      <th>BoW (тексты релизов + числовые переменные) + LogReg</th>
      <td>0.696970</td>
      <td>0.698591</td>
      <td>0.708400</td>
      <td>0.693618</td>
      <td>0.858634</td>
    </tr>
    <tr>
      <th>BoW (тексты релизов) + SVM</th>
      <td>0.666667</td>
      <td>0.676367</td>
      <td>0.695838</td>
      <td>0.667684</td>
      <td>0.836664</td>
    </tr>
    <tr>
      <th>TF-IDF (тексты релизов) + LogReg с L1-регуляризацией</th>
      <td>0.606061</td>
      <td>0.613057</td>
      <td>0.643850</td>
      <td>0.601767</td>
      <td>0.784513</td>
    </tr>
    <tr>
      <th>TF-IDF (тексты релизов c доп. фильтрацией) + LogReg</th>
      <td>0.757576</td>
      <td>0.761220</td>
      <td>0.769459</td>
      <td>0.756484</td>
      <td>0.901979</td>
    </tr>
    <tr>
      <th>TF-IDF (тексты релизов + заголовки) + LogReg</th>
      <td>0.712121</td>
      <td>0.717903</td>
      <td>0.737500</td>
      <td>0.709954</td>
      <td>0.878747</td>
    </tr>
    <tr>
      <th>TF-IDF (тексты релизов + числовые переменные) + LogReg</th>
      <td>0.681818</td>
      <td>0.688457</td>
      <td>0.731248</td>
      <td>0.677314</td>
      <td>0.835872</td>
    </tr>
    <tr style="background-color: yellow;">
      <th>TF-IDF (тексты релизов) + SVM</th>
      <td>0.757576</td>
      <td>0.762899</td>
      <td>0.787698</td>
      <td>0.753432</td>
      <td>0.920457</td>
    </tr>
    <tr>
      <th>Word2Vec + LogReg</th>
      <td>0.575758</td>
      <td>0.578548</td>
      <td>0.576812</td>
      <td>0.580695</td>
      <td>0.744950</td>
    </tr>
    <tr>
      <th>Word2Vec (предобученная модель) + LogReg</th>
      <td>0.590909</td>
      <td>0.603136</td>
      <td>0.628721</td>
      <td>0.590929</td>
      <td>0.760629</td>
    </tr>
    <tr>
      <th>Word2Vec (предобученная модель с фильтрацией) + LogReg</th>
      <td>0.500000</td>
      <td>0.513921</td>
      <td>0.525107</td>
      <td>0.506388</td>
      <td>0.693653</td>
    </tr>
    <tr>
      <th>Word2Vec (предобученная модель) + SVM</th>
      <td>0.560606</td>
      <td>0.569858</td>
      <td>0.569858</td>
      <td>0.569858</td>
      <td>0.745764</td>
    </tr>
    <tr>
      <th>GloVe + LogReg</th>
      <td>0.606061</td>
      <td>0.611108</td>
      <td>0.684127</td>
      <td>0.596904</td>
      <td>0.763597</td>
    </tr>
  </tbody>
</table>

### Выводы

В качестве бейзлайна построена модель, которая возвращает в качестве прогноза предыдущее решение о ставке рефинансирования.

Метрикой качества была выбрана ..., поскольку ... Качество бейзлайна по данной метрике составило ...

В ходе экспериментов было исследовано несколько улучшений базовой модели. Наилучший результат среди них показала модель ...
